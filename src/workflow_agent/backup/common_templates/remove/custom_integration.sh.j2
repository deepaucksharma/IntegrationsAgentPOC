#!/bin/bash
# Custom Integration Uninstall Script
# Generated by New Relic Integration Agent

# Import common functions
{% include 'macros/common.sh.j2' %}

{{ log_message('INFO', 'Starting uninstallation of custom integration') }}

# Set error handling
set -e

# Remove installation directory
INSTALL_DIR="{{ parameters.install_dir | default('/opt/custom-integration') }}"
if [ -d "$INSTALL_DIR" ]; then
    {{ log_message('INFO', 'Removing installation directory...') }}
    rm -rf "$INSTALL_DIR"
fi

# Remove configuration
CONFIG_DIR="{{ parameters.config_path | default('/etc/custom-integration') }}"
if [ -d "$CONFIG_DIR" ]; then
    {{ log_message('INFO', 'Removing configuration directory...') }}
    rm -rf "$CONFIG_DIR"
fi

# Remove any remaining files
find /tmp -name "custom-integration*" -type f -delete 2>/dev/null || true

{{ log_message('INFO', 'Custom integration uninstallation completed successfully') }}
exit 0 