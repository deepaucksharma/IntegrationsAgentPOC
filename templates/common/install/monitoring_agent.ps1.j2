{% import "macros/common.ps1.j2" as common %}
# Windows PowerShell installation script
Set-ExecutionPolicy Bypass -Scope Process -Force
$ErrorActionPreference = "Stop"

# Create installation directory
Write-Host "Creating installation directory..."
New-Item -ItemType Directory -Force -Path "C:\Program Files\Monitoring"

# Write configuration
Write-Host "Writing configuration file..."
@"
license_key: {{ parameters.license_key }}
host: {{ parameters.host }}
"@ | Out-File -FilePath "C:\Program Files\Monitoring\config.yaml" -Encoding UTF8

# Download and install agent (simulated)
Write-Host "Downloading monitoring agent..."
Start-Sleep -Seconds 2

# Start agent (simulated)
Write-Host "Starting monitoring agent..."
Start-Sleep -Seconds 1

Write-Host "Monitoring agent installed successfully!" 